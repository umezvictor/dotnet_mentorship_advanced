è
≠C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Migrations\20251117181325_outbox-table.cs
	namespace 	
DAL
 
. 

Migrations 
{ 
public 
partial 
class 
outboxtable !
:" #
	Migration$ -
{		 
	protected 
override 
void 
Up 
( 
MigrationBuilder .
migrationBuilder/ ?
)? @
{ 
migrationBuilder 
. 
CreateTable 
(  
name 
: 	
$str
 
, 
columns 
: 
table 
=> 
new 
{ 
Id 
= 	
table
 
. 
Column 
< 
int 
> 
( 
type !
:! "
$str# (
,( )
nullable* 2
:2 3
false4 9
): ;
. 

Annotation 
( 
$str '
,' (
$str) /
)0 1
,1 2
Data 	
=
 
table 
. 
Column 
< 
string 
>  
(  !
type" &
:& '
$str( 7
,7 8
nullable9 A
:A B
falseC H
)I J
,J K
IsProcessed 
= 
table 
. 
Column 
<  
bool  $
>$ %
(% &
type' +
:+ ,
$str- 2
,2 3
nullable4 <
:< =
false> C
)D E
,E F
CreatedOnUTC 
= 
table 
. 
Column  
<  !
DateTime! )
>) *
(* +
type, 0
:0 1
$str2 =
,= >
nullable? G
:G H
falseI N
)O P
} 
, 
constraints 
: 
table 
=> 
{ 
table 

.
 

PrimaryKey 
( 
$str "
," #
x$ %
=>& (
x) *
.* +
Id+ -
). /
;/ 0
} 
) 
; 
} 
	protected 
override 
void 
Down 
(  
MigrationBuilder  0
migrationBuilder1 A
)A B
{ 
migrationBuilder   
.   
	DropTable   
(   
name!! 
:!! 	
$str!!
 
)!! 
;!! 
}"" 
}## 
}$$ ‡ 
æC:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Migrations\20251111104726_changed_prinarykey_to_integer.cs
	namespace 	
DAL
 
. 

Migrations 
{ 
public 
partial 
class )
changed_prinarykey_to_integer 3
:4 5
	Migration6 ?
{		 
	protected 
override 
void 
Up 
( 
MigrationBuilder .
migrationBuilder/ ?
)? @
{ 
migrationBuilder 
. 
DropForeignKey "
(" #
name 
: 	
$str
 +
,+ ,
table 	
:	 

$str 
) 
; 
migrationBuilder 
. 
AlterColumn 
<  
int  #
># $
($ %
name 
: 	
$str
 
, 
table 	
:	 

$str 
, 
type 
: 	
$str
 
, 
nullable 
: 
false 
, 

oldClrType 
: 
typeof 
( 
long 
) 
, 
oldType 
: 
$str 
) 
. 

Annotation 
( 
$str %
,% &
$str' -
). /
. 
OldAnnotation 
( 
$str (
,( )
$str* 0
)1 2
;2 3
migrationBuilder 
. 
AddForeignKey !
(! "
name 
: 	
$str
 +
,+ ,
table 	
:	 

$str 
, 
column 

:
 
$str 
, 
principalTable 
: 
$str 
, 
principalColumn   
:   
$str   
,   
onDelete!! 
:!! 
ReferentialAction!! 
.!!  
Cascade!!  '
)!!( )
;!!) *
}"" 
	protected%% 
override%% 
void%% 
Down%% 
(%%  
MigrationBuilder%%  0
migrationBuilder%%1 A
)%%A B
{&& 
migrationBuilder'' 
.'' 
DropForeignKey'' "
(''" #
name(( 
:(( 	
$str((
 +
,((+ ,
table)) 	
:))	 

$str)) 
))) 
;)) 
migrationBuilder++ 
.++ 
AlterColumn++ 
<++  
long++  $
>++$ %
(++% &
name,, 
:,, 	
$str,,
 
,,, 
table-- 	
:--	 

$str-- 
,-- 
type.. 
:.. 	
$str..
 
,.. 
nullable// 
:// 
false// 
,// 

oldClrType00 
:00 
typeof00 
(00 
int00 
)00 
,00 
oldType11 
:11 
$str11 
)11 
.22 

Annotation22 
(22 
$str22 %
,22% &
$str22' -
)22. /
.33 
OldAnnotation33 
(33 
$str33 (
,33( )
$str33* 0
)331 2
;332 3
migrationBuilder55 
.55 
AddForeignKey55 !
(55! "
name66 
:66 	
$str66
 +
,66+ ,
table77 	
:77	 

$str77 
,77 
column88 

:88
 
$str88 
,88 
principalTable99 
:99 
$str99 
,99 
principalColumn:: 
::: 
$str:: 
,:: 
onDelete;; 
:;; 
ReferentialAction;; 
.;;  
Restrict;;  (
);;) *
;;;* +
}<< 
}== 
}>> •
∂C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Migrations\20251019152020_added-parent-category.cs
	namespace 	
DAL
 
. 

Migrations 
{ 
public 
partial 
class 
addedparentcategory )
:* +
	Migration, 5
{		 
	protected 
override 
void 
Up 
( 
MigrationBuilder .
migrationBuilder/ ?
)? @
{ 
migrationBuilder 
. 
	AddColumn 
< 
string $
>$ %
(% &
name 
: 	
$str
 
, 
table 	
:	 

$str 
, 
type 
: 	
$str
 
, 
nullable 
: 
false 
, 
defaultValue 
: 
$str 
) 
; 
} 
	protected 
override 
void 
Down 
(  
MigrationBuilder  0
migrationBuilder1 A
)A B
{ 
migrationBuilder 
. 

DropColumn 
( 
name 
: 	
$str
 
, 
table 	
:	 

$str 
) 
; 
} 
} 
} Å9
≠C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Migrations\20251018094224_added-tables.cs
	namespace 	
DAL
 
. 

Migrations 
{ 
public 
partial 
class 
addedtables !
:" #
	Migration$ -
{		 
	protected 
override 
void 
Up 
( 
MigrationBuilder .
migrationBuilder/ ?
)? @
{ 
migrationBuilder 
. 
DropForeignKey "
(" #
name 
: 	
$str
 +
,+ ,
table 	
:	 

$str 
) 
; 
migrationBuilder 
. 
	AddColumn 
< 
DateTime &
>& '
(' (
name 
: 	
$str
 
, 
table 	
:	 

$str 
, 
type 
: 	
$str
 
, 
nullable 
: 
false 
, 
defaultValue 
: 
new 
DateTime 
( 
$num  !
,! "
$num# $
,$ %
$num& '
,' (
$num) *
,* +
$num, -
,- .
$num/ 0
,0 1
$num2 3
,3 4
DateTimeKind5 A
.A B
UnspecifiedB M
)N O
)P Q
;Q R
migrationBuilder 
. 
	AddColumn 
< 
DateTime &
>& '
(' (
name 
: 	
$str
 
, 
table 	
:	 

$str 
, 
type 
: 	
$str
 
, 
nullable 
: 
false 
, 
defaultValue 
: 
new 
DateTime 
( 
$num  !
,! "
$num# $
,$ %
$num& '
,' (
$num) *
,* +
$num, -
,- .
$num/ 0
,0 1
$num2 3
,3 4
DateTimeKind5 A
.A B
UnspecifiedB M
)N O
)P Q
;Q R
migrationBuilder 
. 
	AddColumn 
< 
DateTime &
>& '
(' (
name   
:   	
$str  
 
,   
table!! 	
:!!	 

$str!! 
,!! 
type"" 
:"" 	
$str""
 
,"" 
nullable## 
:## 
false## 
,## 
defaultValue$$ 
:$$ 
new$$ 
DateTime$$ 
($$ 
$num$$  !
,$$! "
$num$$# $
,$$$ %
$num$$& '
,$$' (
$num$$) *
,$$* +
$num$$, -
,$$- .
$num$$/ 0
,$$0 1
$num$$2 3
,$$3 4
DateTimeKind$$5 A
.$$A B
Unspecified$$B M
)$$N O
)$$P Q
;$$Q R
migrationBuilder&& 
.&& 
	AddColumn&& 
<&& 
DateTime&& &
>&&& '
(&&' (
name'' 
:'' 	
$str''
 
,'' 
table(( 	
:((	 

$str(( 
,(( 
type)) 
:)) 	
$str))
 
,)) 
nullable** 
:** 
false** 
,** 
defaultValue++ 
:++ 
new++ 
DateTime++ 
(++ 
$num++  !
,++! "
$num++# $
,++$ %
$num++& '
,++' (
$num++) *
,++* +
$num++, -
,++- .
$num++/ 0
,++0 1
$num++2 3
,++3 4
DateTimeKind++5 A
.++A B
Unspecified++B M
)++N O
)++P Q
;++Q R
migrationBuilder-- 
.-- 
AddCheckConstraint-- &
(--& '
name.. 
:.. 	
$str..
 
,.. 
table// 	
://	 

$str// 
,// 
sql00 
:00 
$str00	 
)00 
;00 
migrationBuilder22 
.22 
AddForeignKey22 !
(22! "
name33 
:33 	
$str33
 +
,33+ ,
table44 	
:44	 

$str44 
,44 
column55 

:55
 
$str55 
,55 
principalTable66 
:66 
$str66 
,66 
principalColumn77 
:77 
$str77 
,77 
onDelete88 
:88 
ReferentialAction88 
.88  
Restrict88  (
)88) *
;88* +
}99 
	protected<< 
override<< 
void<< 
Down<< 
(<<  
MigrationBuilder<<  0
migrationBuilder<<1 A
)<<A B
{== 
migrationBuilder>> 
.>> 
DropForeignKey>> "
(>>" #
name?? 
:?? 	
$str??
 +
,??+ ,
table@@ 	
:@@	 

$str@@ 
)@@ 
;@@ 
migrationBuilderBB 
.BB 
DropCheckConstraintBB '
(BB' (
nameCC 
:CC 	
$strCC
 
,CC 
tableDD 	
:DD	 

$strDD 
)DD 
;DD 
migrationBuilderFF 
.FF 

DropColumnFF 
(FF 
nameGG 
:GG 	
$strGG
 
,GG 
tableHH 	
:HH	 

$strHH 
)HH 
;HH 
migrationBuilderJJ 
.JJ 

DropColumnJJ 
(JJ 
nameKK 
:KK 	
$strKK
 
,KK 
tableLL 	
:LL	 

$strLL 
)LL 
;LL 
migrationBuilderNN 
.NN 

DropColumnNN 
(NN 
nameOO 
:OO 	
$strOO
 
,OO 
tablePP 	
:PP	 

$strPP 
)PP 
;PP 
migrationBuilderRR 
.RR 

DropColumnRR 
(RR 
nameSS 
:SS 	
$strSS
 
,SS 
tableTT 	
:TT	 

$strTT 
)TT 
;TT 
migrationBuilderVV 
.VV 
AddForeignKeyVV !
(VV! "
nameWW 
:WW 	
$strWW
 +
,WW+ ,
tableXX 	
:XX	 

$strXX 
,XX 
columnYY 

:YY
 
$strYY 
,YY 
principalTableZZ 
:ZZ 
$strZZ 
,ZZ 
principalColumn[[ 
:[[ 
$str[[ 
,[[ 
onDelete\\ 
:\\ 
ReferentialAction\\ 
.\\  
Cascade\\  '
)\\( )
;\\) *
}]] 
}^^ 
}__ √4
√C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Migrations\20251013131747_created-product-and-catalog-tables.cs
	namespace 	
DAL
 
. 

Migrations 
{ 
public 
partial 
class *
createdproductandcatalogtables 4
:5 6
	Migration7 @
{		 
	protected 
override 
void 
Up 
( 
MigrationBuilder .
migrationBuilder/ ?
)? @
{ 
migrationBuilder 
. 
CreateTable 
(  
name 
: 	
$str
 
, 
columns 
: 
table 
=> 
new 
{ 
Id 
= 	
table
 
. 
Column 
< 
int 
> 
( 
type !
:! "
$str# (
,( )
nullable* 2
:2 3
false4 9
): ;
. 

Annotation 
( 
$str '
,' (
$str) /
)0 1
,1 2
Name 	
=
 
table 
. 
Column 
< 
string 
>  
(  !
type" &
:& '
$str( 6
,6 7
	maxLength8 A
:A B
$numC E
,E F
nullableG O
:O P
falseQ V
)W X
,X Y
Image 

= 
table 
. 
Column 
< 
string  
>  !
(! "
type# '
:' (
$str) 8
,8 9
nullable: B
:B C
falseD I
)J K
} 
, 
constraints 
: 
table 
=> 
{ 
table 

.
 

PrimaryKey 
( 
$str $
,$ %
x& '
=>( *
x+ ,
., -
Id- /
)0 1
;1 2
} 
) 
; 
migrationBuilder 
. 
CreateTable 
(  
name 
: 	
$str
 
, 
columns 
: 
table 
=> 
new 
{ 
Id 
= 	
table
 
. 
Column 
< 
long 
> 
( 
type "
:" #
$str$ ,
,, -
nullable. 6
:6 7
false8 =
)> ?
.   

Annotation   
(   
$str   '
,  ' (
$str  ) /
)  0 1
,  1 2
Name!! 	
=!!
 
table!! 
.!! 
Column!! 
<!! 
string!! 
>!!  
(!!  !
type!!" &
:!!& '
$str!!( 6
,!!6 7
	maxLength!!8 A
:!!A B
$num!!C E
,!!E F
nullable!!G O
:!!O P
false!!Q V
)!!W X
,!!X Y
Description"" 
="" 
table"" 
."" 
Column"" 
<""  
string""  &
>""& '
(""' (
type"") -
:""- .
$str""/ >
,""> ?
nullable""@ H
:""H I
false""J O
)""P Q
,""Q R
Price## 

=## 
table## 
.## 
Column## 
<## 
decimal## !
>##! "
(##" #
type##$ (
:##( )
$str##* 9
,##9 :
nullable##; C
:##C D
false##E J
)##K L
,##L M
Amount$$ 
=$$ 
table$$ 
.$$ 
Column$$ 
<$$ 
int$$ 
>$$ 
($$  
type$$! %
:$$% &
$str$$' ,
,$$, -
nullable$$. 6
:$$6 7
false$$8 =
)$$> ?
,$$? @
Image%% 

=%% 
table%% 
.%% 
Column%% 
<%% 
string%%  
>%%  !
(%%! "
type%%# '
:%%' (
$str%%) 8
,%%8 9
nullable%%: B
:%%B C
false%%D I
)%%J K
,%%K L

CategoryId&& 
=&& 
table&& 
.&& 
Column&& 
<&& 
int&& "
>&&" #
(&&# $
type&&% )
:&&) *
$str&&+ 0
,&&0 1
nullable&&2 :
:&&: ;
false&&< A
)&&B C
}'' 
,'' 
constraints(( 
:(( 
table(( 
=>(( 
{)) 
table** 

.**
 

PrimaryKey** 
(** 
$str** $
,**$ %
x**& '
=>**( *
x**+ ,
.**, -
Id**- /
)**0 1
;**1 2
table++ 

.++
 

ForeignKey++ 
(++ 
name,, 

:,,
 
$str,, -
,,,- .
column-- 
:-- 
x-- 
=>-- 
x-- 
.-- 

CategoryId-- 
,--  
principalTable.. 
:.. 
$str..  
,..  !
principalColumn// 
:// 
$str// 
,// 
onDelete00 
:00 
ReferentialAction00 !
.00! "
Cascade00" )
)00* +
;00+ ,
}11 
)11 
;11 
migrationBuilder33 
.33 
CreateIndex33 
(33  
name44 
:44 	
$str44
 "
,44" #
table55 	
:55	 

$str55 
,55 
column66 

:66
 
$str66 
)66 
;66 
}77 
	protected:: 
override:: 
void:: 
Down:: 
(::  
MigrationBuilder::  0
migrationBuilder::1 A
)::A B
{;; 
migrationBuilder<< 
.<< 
	DropTable<< 
(<< 
name== 
:== 	
$str==
 
)== 
;== 
migrationBuilder?? 
.?? 
	DropTable?? 
(?? 
name@@ 
:@@ 	
$str@@
 
)@@ 
;@@ 
}AA 
}BB 
}CC ı
∞C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\EntityConfigurations\ProductConfiguration.cs
	namespace 	
DAL
 
.  
EntityConfigurations "
;" #
internal 
sealed	 
class  
ProductConfiguration *
:+ ,$
IEntityTypeConfiguration- E
<E F
ProductF M
>M N
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder )
<) *
Product* 1
>1 2
builder3 :
): ;
{		 
builder

 	
.

	 

HasKey


 
(

 
x

 
=>

 
x

 
.

 
Id

 
)

 
;

 
builder 	
.	 

Property
 
( 
x 
=> 
x 
. 
Name 
)  !
.! "
HasMaxLength" .
(. /
$num0 2
)3 4
.4 5

IsRequired5 ?
(? @
)@ A
;A B
builder 	
.	 

Property
 
( 
p 
=> 
p 
. 
Price  
)! "
." #
HasColumnType# 0
(0 1
$str2 A
)B C
.C D

IsRequiredD N
(N O
)O P
;P Q
builder 	
.	 

Property
 
( 
p 
=> 
p 
. 
Amount !
)" #
.# $

IsRequired$ .
(. /
)/ 0
;0 1
builder 	
.	 

ToTable
 
( 
t 
=> 
t 
. 
HasCheckConstraint ,
(, -
$str. B
,B C
$strD R
)S T
)U V
;V W
builder 	
.	 

HasOne
 
( 
x 
=> 
x 
. 
Category !
)" #
.# $
WithMany$ ,
(, -
u. /
=>0 2
u3 4
.4 5
Products5 =
)> ?
.? @
HasForeignKey@ M
(M N
xO P
=>Q S
xT U
.U V

CategoryIdV `
)a b
.b c

IsRequiredc m
(m n
)n o
;o p
} 
} –
±C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\EntityConfigurations\CategoryConfiguration.cs
	namespace 	
DAL
 
.  
EntityConfigurations "
;" #
internal 
sealed	 
class !
CategoryConfiguration +
:, -$
IEntityTypeConfiguration. F
<F G
CategoryG O
>O P
{ 
public 
void 
	Configure 
( 
EntityTypeBuilder )
<) *
Category* 2
>2 3
builder4 ;
); <
{		 
builder 	
.	 

HasKey
 
( 
x 
=> 
x 
. 
Id 
) 
; 
builder 	
.	 

Property
 
( 
x 
=> 
x 
. 
Name 
)  !
.! "
HasMaxLength" .
(. /
$num0 2
)3 4
.4 5

IsRequired5 ?
(? @
)@ A
;A B
builder 	
.	 

HasMany
 
( 
x 
=> 
x 
. 
Products "
)# $
.$ %
WithOne% ,
(, -
u. /
=>0 2
u3 4
.4 5
Category5 =
)> ?
.? @
HasForeignKey@ M
(M N
xO P
=>Q S
xT U
.U V

CategoryIdV `
)a b
. 
OnDelete 
( 
DeleteBehavior 
. 
Cascade $
)% &
;& '
} 
} ¿
óC:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Entities\Product.cs
	namespace 	
DAL
 
. 
Entities 
; 
public 
sealed 
class 
Product 
: 
AuditableEntity -
{ 
[ 
Key 
] 
public 
int 
Id 
{ 
get 
; 
set 
; 
} 
public		 
required		 
string		 
Name		 
{		 
get		 "
;		" #
set		$ '
;		' (
}		) *
public

 
string

 
Description

 
{

 
get

  
;

  !
set

" %
;

% &
}

' (
=

) *
string

+ 1
.

1 2
Empty

2 7
;

7 8
[ 
Required 

]
 
public 
decimal 
Price 
{ 
get 
; 
set  
;  !
}" #
[ 
Required 

]
 
public 
int 
Amount 
{ 
get 
; 
set 
; 
}  
public 
string 
Image 
{ 
get 
; 
set 
;  
}! "
=# $
string% +
.+ ,
Empty, 1
;1 2
public 
int 

CategoryId 
{ 
get 
; 
set !
;! "
}# $
public 
required 
Category 
Category "
{# $
get% (
;( )
set* -
;- .
}/ 0
} ≤
ñC:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Entities\Outbox.cs
	namespace 	
DAL
 
. 
Entities 
; 
public 
sealed 
class 
Outbox 
{ 
[ 
Key 
] 
public 
int 
Id 
{ 
get 
; 
set 
; 
} 
public 
string 
Data 
{ 
get 
; 
set 
; 
}  !
=" #
null$ (
!( )
;) *
public		 
bool		 
IsProcessed		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
public

 
DateTime

 
CreatedOnUTC

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
} º
òC:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Entities\Category.cs
	namespace 	
DAL
 
. 
Entities 
; 
public 
sealed 
class 
Category 
: 
AuditableEntity .
{ 
[ 
Key 
] 
public 
int 
Id 
{ 
get 
; 
set 
; 
} 
public 
required 
string 
Name 
{ 
get "
;" #
set$ '
;' (
}) *
public		 
string		 
Image		 
{		 
get		 
;		 
set		 
;		  
}		! "
=		# $
string		% +
.		+ ,
Empty		, 1
;		1 2
public

 
string

 
ParentCategory

 
{

 
get

  #
;

# $
set

% (
;

( )
}

* +
=

, -
string

. 4
.

4 5
Empty

5 :
;

: ;
public 
List 
< 
Product 
> 
Products 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
new/ 2
List3 7
<7 8
Product8 ?
>? @
(@ A
)A B
;B C
} ¨
üC:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Entities\AuditableEntity.cs
	namespace 	
DAL
 
. 
Entities 
; 
public 
abstract 
class 
AuditableEntity %
{ 
public 
DateTime 
	CreatedAt 
{ 
get  
;  !
set" %
;% &
}' (
public 
DateTime 
	UpdatedAt 
{ 
get  
;  !
set" %
;% &
}' (
} ∏
öC:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\DependencyInjection.cs
	namespace 	
DAL
 
; 
public 
static 
class 
DependencyInjection '
{		 
public

 
static

 
IServiceCollection

 !
AddDataAccessLayer

" 4
(

5 6
this

6 :
IServiceCollection

; M
services

N V
,

V W
IConfiguration

X f
configuration

g t
)

t u
=>

v x
services 

.
 
AddDatabase 
( 
configuration %
)& '
;' (
private 
static	 
IServiceCollection "
AddDatabase# .
(/ 0
this0 4
IServiceCollection5 G
servicesH P
,P Q
IConfigurationR `
configurationa n
)n o
{ 
services 

.
 
AddDbContext 
<  
ApplicationDbContext ,
>, -
(- .
options/ 6
=>7 9
options 	
.	 

UseSqlServer
 
( 
configuration 
. 
GetConnectionString $
($ %
$str& 9
): ;
,; <
b 
=> 
b 	
.	 

MigrationsAssembly
 
( 
typeof $
($ % 
ApplicationDbContext& :
); <
.< =
Assembly= E
.E F
FullNameF N
)O P
)Q R
)S T
;T U
services 

.
 
	AddScoped 
< !
IApplicationDbContext *
>* +
(+ ,
sp- /
=>0 2
sp3 5
.5 6
GetRequiredService6 H
<H I 
ApplicationDbContextI ]
>] ^
(^ _
)_ `
)a b
;b c
services 

.
 
	AddScoped 
< 
IProductRepository '
,' (
ProductRepository) :
>: ;
(; <
)< =
;= >
services 

.
 
	AddScoped 
< 
ICategoryRepository (
,( )
CategoryRepository* <
>< =
(= >
)> ?
;? @
return 
services	 
; 
} 
} ´;
¨C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Database\Repository\ProductRepository.cs
	namespace 	
DAL
 
. 
Database 
. 

Repository !
;! "
public 
sealed 
class 
ProductRepository %
(& ' 
ApplicationDbContext' ;
_context< D
)D E
:F G
IProductRepositoryH Z
{ 
public

 
async

 
Task

 
<

 
int

 
>

 
CreateAsync

 #
(

$ %
Product

% ,
product

- 4
,

4 5
CancellationToken

6 G
cancellationToken

H Y
)

Y Z
{ 
var 
createdItem 
= 
await 
_context "
." #
Products# +
.+ ,
AddAsync, 4
(4 5
product6 =
,= >
cancellationToken? P
)Q R
;R S
await 
_context 
. 
SaveChangesAsync !
(! "
cancellationToken# 4
)5 6
;6 7
return 
createdItem	 
. 
Entity 
. 
Id 
; 
} 
public 
async 
Task 
< 
Product 
? 
> 
GetByIdAsync )
(* +
long+ /
id0 2
,2 3
CancellationToken4 E
cancellationTokenF W
)W X
{ 
return 
await	 
_context 
. 
Products  
. 
Where 	
(	 

x 
=> 
x 
. 
Id 
== 
id 
) 
. 
FirstOrDefaultAsync 
( 
cancellationToken *
)+ ,
;, -
} 
public 
async 
Task 
< 
List 
< 
Product 
>  
>  !
GetAllProductsAsync" 5
(6 7
CancellationToken7 H
cancellationTokenI Z
)Z [
{ 
return 
await	 
_context 
. 
Products  
. 
AsNoTracking 
( 
) 
. 
ToListAsync 
( 
cancellationToken "
)# $
;$ %
} 
public"" 
async"" 
Task"" 
<"" 
PaginatedResponse"" $
<""$ %
List""% )
<"") *

ProductDto""* 4
>""4 5
>""5 6
>""6 7(
GetProductsByCategoryIdAsync""8 T
(""U V
int""V Y

categoryId""Z d
,""d e
int""f i

pageNumber""j t
,""t u
int""v y
pageSize	""z Ç
,
""Ç É
CancellationToken
""Ñ ï
cancellationToken
""ñ ß
)
""ß ®
{## 
PaginatedResponse$$ 
<$$ 
List$$ 
<$$ 

ProductDto$$ #
>$$# $
>$$$ %
paginatedResponse$$& 7
=$$8 9
new$$: =
PaginatedResponse$$> O
<$$O P
List$$P T
<$$T U

ProductDto$$U _
>$$_ `
>$$` a
($$a b
)$$b c
;$$c d
if&& 
(&& 

pageNumber&& 
<=&& 
$num&& 
)&& 

pageNumber&& !
=&&" #
$num&&$ %
;&&% &
if'' 
('' 
pageSize'' 
<='' 
$num'' 
)'' 
pageSize'' 
='' 
$num''  "
;''" #
paginatedResponse)) 
.)) 
PageSize)) 
=)) 
pageSize)) '
;))' (
var** 
query** 
=** 
_context** 
.** 
Products** 
.**  
Where**  %
(**% &
u**' (
=>**) +
u**, -
.**- .

CategoryId**. 8
==**9 ;

categoryId**< F
)**G H
;**H I
paginatedResponse++ 
.++ 

TotalCount++ 
=++  
await++! &
query++' ,
.++, -

CountAsync++- 7
(++7 8
)++8 9
;++9 :
paginatedResponse-- 
.-- 
Data-- 
=-- 
await--  
_context--! )
.--) *
Products--* 2
.--2 3
Where--3 8
(--8 9
p--: ;
=>--< >
p--? @
.--@ A

CategoryId--A K
==--L N

categoryId--O Y
)--Z [
... 
Select.. 

(..
 
o.. 
=>.. 
new.. 

ProductDto.. 
{// 
Id00 
=00 
o00	 

.00
 
Id00 
,00 
Amount11 

=11 
o11 
.11 
Amount11 
,11 
Image22 	
=22
 
o22 
.22 
Image22 
??22 
$str22 
,22 
Name33 
=33	 

o33 
.33 
Name33 
,33 
Price44 	
=44
 
o44 
.44 
Price44 
,44 

CategoryId55 
=55 
o55 
.55 

CategoryId55 
,55 
}77 
)77 
.88 
Skip88 
(88 
(88	 


pageNumber88
 
-88 
$num88 
)88 
*88 
pageSize88 $
)88% &
.99 
Take99 
(99 
pageSize99	 
)99 
.:: 
ToListAsync:: 
(:: 
):: 
;:: 
return;; 
paginatedResponse;;	 
;;; 
}<< 
public?? 
async?? 
Task?? 
DeleteAsync?? 
(??  
Product??  '
product??( /
,??/ 0
CancellationToken??1 B
cancellationToken??C T
)??T U
{@@ 
_contextAA 

.AA
 
ProductsAA 
.AA 
RemoveAA 
(AA 
productAA #
)AA$ %
;AA% &
awaitBB 
_contextBB 
.BB 
SaveChangesAsyncBB !
(BB! "
cancellationTokenBB# 4
)BB5 6
;BB6 7
}CC 
publicEE 
asyncEE 
TaskEE 
<EE 
ProductEE 
>EE 
UpdateAsyncEE '
(EE( )
ProductEE) 0
productEE1 8
,EE8 9
CancellationTokenEE: K
cancellationTokenEEL ]
)EE] ^
{FF 
varGG 
updatedItemGG 
=GG 
_contextGG 
.GG 
ProductsGG %
.GG% &
UpdateGG& ,
(GG, -
productGG. 5
)GG6 7
;GG7 8
awaitHH 
_contextHH 
.HH 
SaveChangesAsyncHH !
(HH! "
cancellationTokenHH# 4
)HH5 6
;HH6 7
returnII 
updatedItemII	 
.II 
EntityII 
;II 
}JJ 
}KK Â
≠C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Database\Repository\IProductRepository.cs
	namespace 	
DAL
 
. 
Database 
. 

Repository !
;! "
public 
	interface 
IProductRepository #
{ 
Task 
< 
int 	
>	 

CreateAsync 
( 
Product 
product  '
,' (
CancellationToken) :
cancellationToken; L
)L M
;M N
Task		 
DeleteAsync		 
(		 
Product		 
product		 "
,		" #
CancellationToken		$ 5
cancellationToken		6 G
)		G H
;		H I
Task

 
<

 
List

 

<


 
Product

 
>

 
>

 
GetAllProductsAsync

 (
(

) *
CancellationToken

* ;
cancellationToken

< M
)

M N
;

N O
Task 
< 
Product 
? 
> 
GetByIdAsync 
( 
long "
id# %
,% &
CancellationToken' 8
cancellationToken9 J
)J K
;K L
Task 
< 
Product 
> 
UpdateAsync 
( 
Product #
product$ +
,+ ,
CancellationToken- >
cancellationToken? P
)P Q
;Q R
Task 
< 
PaginatedResponse 
< 
List 
< 

ProductDto '
>' (
>( )
>) *(
GetProductsByCategoryIdAsync+ G
(H I
intI L

categoryIdM W
,W X
intY \

pageNumber] g
,g h
inti l
pageSizem u
,u v
CancellationToken	w à
cancellationToken
â ö
)
ö õ
;
õ ú
} Ü
ÆC:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Database\Repository\ICategoryRepository.cs
	namespace 	
DAL
 
. 
Database 
. 

Repository !
;! "
public 
	interface 
ICategoryRepository $
{ 
Task 
< 
int 	
>	 

CreateAsync 
( 
Category  
category! )
,) *
CancellationToken+ <
cancellationToken= N
)N O
;O P
Task 
< 
List 

<
 
Category 
> 
> !
GetAllCategoriesAsync +
(, -
CancellationToken- >
cancellationToken? P
)P Q
;Q R
Task 
< 
Category 
? 
> 
GetByIdAsync 
( 
int "
id# %
,% &
CancellationToken' 8
?8 9
cancellationToken: K
)K L
;L M
Task		 
<		 
Category		 
>		 
UpdateAsync		 
(		 
Category		 %
category		& .
,		. /
CancellationToken		0 A
cancellationToken		B S
)		S T
;		T U
Task

 
DeleteAsync

 
(

 
int

 

categoryId

 !
,

! "
CancellationToken

# 4
cancellationToken

5 F
)

F G
;

G H
} ‹$
≠C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Database\Repository\CategoryRepository.cs
	namespace 	
DAL
 
. 
Database 
. 

Repository !
;! "
public 
sealed 
class 
CategoryRepository &
(' ( 
ApplicationDbContext( <
_context= E
)E F
:G H
ICategoryRepositoryI \
{ 
public 
async 
Task 
< 
int 
> 
CreateAsync #
($ %
Category% -
category. 6
,6 7
CancellationToken8 I
cancellationTokenJ [
)[ \
{ 
var

 
createdItem

 
=

 
await

 
_context

 "
.

" #
Category

# +
.

+ ,
AddAsync

, 4
(

4 5
category

6 >
)

? @
;

@ A
await 
_context 
. 
SaveChangesAsync !
(! "
cancellationToken# 4
)5 6
;6 7
return 
createdItem	 
. 
Entity 
. 
Id 
; 
} 
public 
async 
Task 
< 
Category 
? 
> 
GetByIdAsync *
(+ ,
int, /
id0 2
,2 3
CancellationToken4 E
?E F
cancellationTokenG X
)X Y
{ 
return 
await	 
_context 
. 
Category  
.  !
Where! &
(& '
x( )
=>* ,
x- .
.. /
Id/ 1
==2 4
id5 7
)8 9
.9 :
FirstOrDefaultAsync: M
(M N
)N O
;O P
} 
public 
async 
Task 
< 
List 
< 
Category  
>  !
>! "!
GetAllCategoriesAsync# 8
(9 :
CancellationToken: K
cancellationTokenL ]
)] ^
{ 
return 
await	 
_context 
. 
Category  
.  !
AsNoTracking! -
(- .
). /
./ 0
ToListAsync0 ;
(; <
cancellationToken= N
)O P
;P Q
} 
public 
async 
Task 
DeleteAsync 
(  
int  #

categoryId$ .
,. /
CancellationToken0 A
cancellationTokenB S
)S T
{   
var!! 
category!! 
=!! 
await!! 
_context!! 
.!!  
Category!!  (
."" 
Include"" 
("" 
c"" 
=>"" 
c"" 
."" 
Products"" 
)"" 
.## 
FirstOrDefaultAsync## 
(## 
c## 
=>## 
c## 
.##  
Id##  "
==### %

categoryId##& 0
,##0 1
cancellationToken##2 C
)##D E
;##E F
if%% 
(%% 
category%% 
!=%% 
null%% 
)%% 
{&& 
_context'' 
.'' 
Category'' 
.'' 
Remove'' 
('' 
category'' %
)''& '
;''' (
await(( 
_context((	 
.(( 
SaveChangesAsync(( "
(((" #
cancellationToken(($ 5
)((6 7
;((7 8
})) 
}** 
public,, 
async,, 
Task,, 
<,, 
Category,, 
>,, 
UpdateAsync,, (
(,,) *
Category,,* 2
category,,3 ;
,,,; <
CancellationToken,,= N
cancellationToken,,O `
),,` a
{-- 
var.. 
updatedItem.. 
=.. 
_context.. 
... 
Category.. %
...% &
Update..& ,
(.., -
category... 6
)..7 8
;..8 9
await// 
_context// 
.// 
SaveChangesAsync// !
(//! "
)//" #
;//# $
return00 
updatedItem00	 
.00 
Entity00 
;00 
}11 
}22 Æ

•C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Database\IApplicationDbContext.cs
	namespace 	
DAL
 
. 
Database 
; 
public 
	interface !
IApplicationDbContext &
{ 
public 
DbSet 
< 
Product 
> 
Products 
{  !
get" %
;% &
set' *
;* +
}, -
public		 
DbSet		 
<		 
Category		 
>		 
Category		  
{		! "
get		# &
;		& '
set		( +
;		+ ,
}		- .
public

 
DbSet

 
<

 
Outbox

 
>

 
Outbox

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
Task 
< 
int 	
>	 

SaveChangesAsync 
( 
CancellationToken .
cancellationToken/ @
=A B
defaultC J
)J K
;K L
DatabaseFacade 
Database 
{ 
get 
; 
}  !
} §
§C:\Users\ChibuzorUmezuruike\Documents\Victor\.Net_Mentorship_Program_Advanced\DotnetAdvancedEcommerceProject\src\CatalogService\DAL\Database\ApplicationDbContext.cs
	namespace 	
DAL
 
. 
Database 
; 
public 
class  
ApplicationDbContext !
:" #
	DbContext$ -
,- .!
IApplicationDbContext/ D
{ 
public		  
ApplicationDbContext		 
(		 
DbContextOptions		 .
<		. / 
ApplicationDbContext		/ C
>		C D
options		E L
)		L M
:		N O
base		P T
(		T U
options		V ]
)		^ _
{

 
} 
public 
DbSet 
< 
Product 
> 
Products 
{  !
get" %
;% &
set' *
;* +
}, -
public 
DbSet 
< 
Category 
> 
Category  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
DbSet 
< 
Outbox 
> 
Outbox 
{ 
get "
;" #
set$ '
;' (
}) *
public 
new 
DatabaseFacade 
Database #
=>$ &
base' +
.+ ,
Database, 4
;4 5
	protected 

override 
void 
OnModelCreating (
() *
ModelBuilder* 6
modelBuilder7 C
)C D
{ 
base 
. 
OnModelCreating 
( 
modelBuilder $
)% &
;& '
modelBuilder 
. +
ApplyConfigurationsFromAssembly .
(. /
typeof0 6
(6 7 
ApplicationDbContext8 L
)M N
.N O
AssemblyO W
)X Y
;Y Z
} 
public 
override 
Task 
< 
int 
> 
SaveChangesAsync +
(, -
CancellationToken- >
cancellationToken? P
=Q R
defaultS Z
)Z [
{ 
var 
entries 
= 
ChangeTracker 
. 
Entries %
<% &
AuditableEntity& 5
>5 6
(6 7
)7 8
;8 9
foreach 	
(
 
var 
entry 
in 
entries 
)  
{ 
if 
( 
entry 
. 
State 
== 
EntityState !
.! "
Added" '
)' (
{ 
entry 	
.	 

Entity
 
. 
	CreatedAt 
= 
DateTime %
.% &
UtcNow& ,
;, -
}   
else!! 
if!! 

(!! 
entry!! 
.!! 
State!! 
==!! 
EntityState!! &
.!!& '
Modified!!' /
)!!/ 0
{"" 
entry## 	
.##	 

Entity##
 
.## 
	UpdatedAt## 
=## 
DateTime## %
.##% &
UtcNow##& ,
;##, -
}$$ 
}%% 
return&& 
base&&	 
.&& 
SaveChangesAsync&& 
(&& 
cancellationToken&&  1
)&&2 3
;&&3 4
}'' 
}(( 